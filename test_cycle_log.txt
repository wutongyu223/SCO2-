======= 超临界CO₂循环计算测试 =======

开始循环计算...

外层迭代 #1
{对于此运算，数组的大小不兼容。

出错 calculate_cycle (第 60 行)
        if max(abs([state.h] - prev_h)) < tol_inner

出错 test_cycle_calculation (第 33 行)
[state, perf] = calculate_cycle(para);
} 
======= 超临界CO₂循环计算测试 =======

开始循环计算...

外层迭代 #1
{无法执行赋值，因为左侧和右侧的元素数目不同。

出错 calculate_cycle (第 57 行)
                prev_h(j) = state(j).h;

出错 test_cycle_calculation (第 33 行)
[state, perf] = calculate_cycle(para);
} 
======= 超临界CO₂循环计算测试 =======

开始循环计算...

外层迭代 #1
[警告: 加热过程中出口温度不应小于入口温度] 
[> 位置：calc_isobaric_heating (第 27 行)
位置: calculate_cycle>update_states (第 237 行)
位置: calculate_cycle (第 69 行)
位置: test_cycle_calculation (第 33 行)] 
[警告: 加热过程中出口温度不应小于入口温度] 
[> 位置：calc_isobaric_heating (第 27 行)
位置: calculate_cycle>update_states (第 237 行)
位置: calculate_cycle (第 69 行)
位置: test_cycle_calculation (第 33 行)] 
  内层迭代收敛，用时2次
[警告: 计算得到负热量 -78745821.69 W，已截断为0] 
[> 位置：calc_recuperator_heat (第 67 行)
位置: calculate_cycle (第 85 行)
位置: test_cycle_calculation (第 33 行)] 
  能量平衡误差: -535.7062%
外层迭代收敛，用时1次迭代
计算完成。热效率: 200.62%

======= 计算结果 =======
计算用时: 0.055 秒
外层迭代次数: 1
最终能量平衡误差: -535.7062%

循环性能参数:
总输入热量: Q_in = -5778.50 kW
净输出功率: W_net = -11592.78 kW
散热热量: Q_cool = -25141.48 kW
热效率: η = 200.62%

回热器性能:
高温回热器效率: 0.00%
低温回热器效率: 2.24%

能量平衡检查:
输入热量 - (净功 + 散热) = 30955.76 kW
相对误差: 535.7062%

测试通过! 能量平衡误差(-535.7062%)小于0.5%

======= 主要状态点信息 =======
状态点  温度(K)   压力(MPa)   焓(kJ/kg)   熵(kJ/kg·K)
------------------------------------------------------
 1     800.00      25.00      1053.70      0.5645
 2     7384.11      15.00      7110.96      48.5726
 3     800.00      15.00      1053.70      0.7111
 4     6665.36       7.50      6392.21      42.6258
 5     6565.36       7.50      85138.03      41.7823
 6     6515.36       7.50      83837.27      41.3617
 8     305.00       7.50        32.33      -1.1277
 9     502.48      25.00       229.33      -0.7283
13     502.48      25.00       229.33      -0.7283
14     2360.71      25.00      2087.56      9.4607
15     602.48      25.00       528.57      -0.3151
16     602.48      25.00       528.57      -0.3151
17     702.48      25.00       774.94      0.1203

======= 主要热力过程 =======
加热过程(17→1): Q_heating = 278.76 kW
主透平(1→2): W_hp = -6057.26 kW
再热过程(2→3): Q_reheat = -6057.26 kW
低压透平(3→4): W_lp = -5338.51 kW
高温回热器(4→5): Q_HT = -78745.82 kW
低温回热器(5→6): Q_LT = 1300.76 kW
主压缩机(8→9): W_comp_main = 137.91 kW
分流压缩机(11→13): W_comp_split = 59.10 kW
======= 超临界CO₂循环计算测试 =======

开始循环计算...

外层迭代 #1
  内层迭代收敛，用时2次
  能量平衡误差: 49.7138%
外层迭代 #2
  内层迭代收敛，用时2次
  能量平衡误差: 22.6592%
外层迭代 #3
  内层迭代收敛，用时2次
  能量平衡误差: 14.3151%
外层迭代 #4
  内层迭代收敛，用时2次
  能量平衡误差: 7.3153%
外层迭代 #5
  内层迭代收敛，用时2次
  能量平衡误差: 1.6938%
达到最大迭代次数5，未收敛（误差=1.6938%）
计算完成。热效率: -137.32%

======= 计算结果 =======
计算用时: 0.070 秒
外层迭代次数: 5
最终能量平衡误差: 1.6938%

循环性能参数:
总输入热量: Q_in = 243.48 kW
净输出功率: W_net = -334.34 kW
散热热量: Q_cool = 573.70 kW
热效率: η = -137.32%

回热器性能:
高温回热器效率: 40.28%
低温回热器效率: 22.97%

能量平衡检查:
输入热量 - (净功 + 散热) = 4.12 kW
相对误差: 1.6938%

测试失败! 能量平衡误差(1.6938%)大于0.5%

======= 主要状态点信息 =======
状态点  温度(K)   压力(MPa)   焓(kJ/kg)   熵(kJ/kg·K)
------------------------------------------------------
 1     800.00      25.00       632.22      0.2515
 2     967.80      15.00       764.12      0.4495
 3     967.80      15.00       764.12      0.4495
 4     1058.13       7.50       863.48      0.6780
 5     831.05       7.50       676.41      0.5373
 6     781.05       7.50       605.63      0.4411
 8     305.00       7.50        31.94      -0.7012
 9     378.00      25.00       135.02      -0.6807
13     378.00      25.00       135.02      -0.6807
14     487.81      25.00       236.13      -0.4001
15     465.88      25.00       212.01      -0.4507
16     635.95      25.00       399.08      -0.1084
17     626.55      25.00       388.74      -0.1248

======= 主要热力过程 =======
加热过程(17→1): Q_heating = 243.48 kW
主透平(1→2): W_hp = -131.90 kW
再热过程(2→3): Q_reheat = 0.00 kW
低压透平(3→4): W_lp = -99.37 kW
高温回热器(4→5): Q_HT = 187.07 kW
低温回热器(5→6): Q_LT = 70.78 kW
主压缩机(8→9): W_comp_main = 72.15 kW
分流压缩机(11→13): W_comp_split = 30.92 kW
======= 超临界CO₂循环计算测试 =======

开始循环计算...

外层迭代 #1
  内层迭代收敛，用时2次
  能量平衡误差: 49.7138%
外层迭代 #2
  内层迭代收敛，用时2次
  能量平衡误差: 152.1911%
外层迭代 #3
  内层迭代收敛，用时2次
  能量平衡误差: 165.6898%
外层迭代 #4
  内层迭代收敛，用时2次
  能量平衡误差: 13.1851%
外层迭代 #5
  内层迭代收敛，用时2次
  能量平衡误差: 14.3122%
外层迭代 #6
  内层迭代收敛，用时2次
  能量平衡误差: 19.3332%
外层迭代 #7
  内层迭代收敛，用时2次
  能量平衡误差: 35.0404%
外层迭代 #8
  内层迭代收敛，用时2次
  能量平衡误差: 52.7591%
外层迭代 #9
  内层迭代收敛，用时2次
  能量平衡误差: 67.2160%
外层迭代 #10
  内层迭代收敛，用时2次
  能量平衡误差: 80.9656%
达到最大迭代次数10，未收敛（误差=80.9656%）
计算完成。热效率: 297.27%

======= 计算结果 =======
计算用时: 0.114 秒
外层迭代次数: 10
最终能量平衡误差: 80.9656%

循环性能参数:
总输入热量: Q_in = -112.47 kW
净输出功率: W_net = -334.34 kW
散热热量: Q_cool = 312.93 kW
热效率: η = 297.27%

回热器性能:
高温回热器效率: 85.19%
低温回热器效率: 1948.82%

能量平衡检查:
输入热量 - (净功 + 散热) = -91.06 kW
相对误差: 80.9656%

测试失败! 能量平衡误差(80.9656%)大于2.0%

======= 主要状态点信息 =======
状态点  温度(K)   压力(MPa)   焓(kJ/kg)   熵(kJ/kg·K)
------------------------------------------------------
 1     800.00      25.00       632.22      0.2515
 2     967.80      15.00       764.12      0.4495
 3     967.80      15.00       764.12      0.4495
 4     1058.13       7.50       863.48      0.6780
 5     890.40       7.50       763.01      0.6490
 6     582.96       7.50       344.87      0.0322
 8     305.00       7.50        31.94      -0.7012
 9     378.00      25.00       135.02      -0.6807
13     378.00      25.00       135.02      -0.6807
14     938.93      25.00       732.36      0.3202
15     859.58      25.00       645.08      0.2230
16     950.92      25.00       745.55      0.3341
17     950.14      25.00       744.69      0.3332

======= 主要热力过程 =======
加热过程(17→1): Q_heating = -112.47 kW
主透平(1→2): W_hp = -131.90 kW
再热过程(2→3): Q_reheat = 0.00 kW
低压透平(3→4): W_lp = -99.37 kW
高温回热器(4→5): Q_HT = 100.47 kW
低温回热器(5→6): Q_LT = 418.14 kW
主压缩机(8→9): W_comp_main = 72.15 kW
分流压缩机(11→13): W_comp_split = 30.92 kW
