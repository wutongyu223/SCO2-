# 超临界CO₂布雷顿循环计算模型

本文档基于`calautatlion_renum.m`程序，详细说明了超临界CO₂布雷顿循环的计算模型和方法。

## 1. 系统概述

超临界CO₂布雷顿循环由以下组件组成：
- 高压透平(HP)和低压透平(LP)
- 再热器
- 高温回热器(HTR)和低温回热器(LTR)
- 主路冷却器和中间冷却器
- 主压缩机a和b以及副压缩机
- 分流-合流系统

循环流程设计为15个热力学状态点，具体如下：

1. 高压透平入口
2. 高压透平出口/再热器入口
3. 再热器出口/低压透平入口
4. 低压透平出口/高温回热器热侧入口
5. 高温回热器热侧出口/低温回热器热侧入口
6. 低温回热器热侧出口/分流点
7. 冷却器出口/主压缩机a入口
8. 主压缩机a出口/中间冷却器入口
9. 中间冷却器出口/主压缩机b入口
10. 主压缩机b出口
11. 副压缩机入口（从分流点6分出）
12. 副压缩机出口
13. 合流点/低温回热器冷侧入口
14. 低温回热器冷侧出口/高温回热器冷侧入口
15. 高温回热器冷侧出口/加热器入口

## 2. 初始参数

### 2.1 效率参数

| 参数      | 符号                  | 值    |
| ------- | ------------------- | ---- |
| 高压透平效率  | $\eta_{HP}$         | 0.93 |
| 低压透平效率  | $\eta_{LP}$         | 0.93 |
| 主压缩机a效率 | $\eta_{MC,a}$       | 0.89 |
| 主压缩机b效率 | $\eta_{MC,b}$       | 0.89 |
| 副压缩机效率  | $\eta_{RC}$         | 0.89 |
| 低温回热器效率 | $\varepsilon_{LTR}$ | 0.86 |
| 高温回热器效率 | $\varepsilon_{HTR}$ | 0.86 |
| 加热器效率   | $\eta_{heater}$     | 0.94 |

### 2.2 工况参数

| 参数        | 符号               | 值      | 单位  |
| --------- | ---------------- | ------ | --- |
| 高压透平入口压力  | $P_1$            | 21     | MPa |
| 高压透平入口温度  | $T_1$            | 873    | K   |
| 高压透平出口压力  | $P_2$            | 15     | MPa |
| 低压透平出口压力  | $P_4$            | 7.5729 | MPa |
| 主压缩机a出口压力 | $P_8$            | 12     | MPa |
| 冷却器出口温度   | $T_7$            | 305    | K   |
| 中间冷却器出口温度 | $T_9$            | 305    | K   |
| 高温回热器温差   | $\Delta T_{HTR}$ | 20     | K   |
| 低温回热器温差   | $\Delta T_{LTR}$ | 20     | K   |
| 分流比例      | $\alpha$         | 0.3333 | -   |

## 3. 热力学计算

### 3.1 高压透平 (1→2)

高压透平入口状态计算：
$$P_1 = 21 \text{ MPa}$$
$$T_1 = 873 \text{ K}$$
$$s_1 = \text{refpropm}('s','T',T_1,'P',P_1\times1000,\text{'CO2'})$$
$$h_1 = \text{refpropm}('h','T',T_1,'P',P_1\times1000,\text{'CO2'})$$

高压透平等熵过程计算：
$$s_{2,is} = s_1 \text{ (等熵过程)}$$
$$h_{2,is} = \text{refpropm}('h','P',P_2\times1000,'S',s_{2,is},\text{'CO2'})$$

考虑透平效率的实际出口焓：
$$h_2 = h_1 - \eta_{HP} \times (h_1 - h_{2,is})$$

出口状态计算：
$$T_2 = \text{refpropm}('t','P',P_2\times1000,'H',h_2,\text{'CO2'})$$
$$s_2 = \text{refpropm}('s','T',T_2,'P',P_2\times1000,\text{'CO2'})$$

### 3.2 再热器 (2→3)

再热过程计算（等压加热）：
$$P_3 = P_2 \text{ (等压过程)}$$
$$T_3 = T_1 \text{ (再热到初始温度)}$$
$$h_3 = \text{refpropm}('h','T',T_3,'P',P_3\times1000,\text{'CO2'})$$
$$s_3 = \text{refpropm}('s','T',T_3,'P',P_3\times1000,\text{'CO2'})$$

### 3.3 低压透平 (3→4)

低压透平等熵过程计算：
$$s_{4,is} = s_3 \text{ (等熵过程)}$$
$$h_{4,is} = \text{refpropm}('h','P',P_4\times1000,'S',s_{4,is},\text{'CO2'})$$

考虑透平效率的实际出口焓：
$$h_4 = h_3 - \eta_{LP} \times (h_3 - h_{4,is})$$

出口状态计算：
$$T_4 = \text{refpropm}('t','P',P_4\times1000,'H',h_4,\text{'CO2'})$$
$$s_4 = \text{refpropm}('s','T',T_4,'P',P_4\times1000,\text{'CO2'})$$

### 3.4 回热器初始估计

#### 3.4.1 新的基于合流点的初始化方法

本模型采用了基于合流点反向计算的初始化方法，这种方法优于简单温差估计，可提高计算稳定性和收敛速度。

1. 首先估计副压缩机入口状态：
   ```
   T_{11,est} = 320 \text{ K (估计值)}
   h_{11,est} = \text{refpropm}('h','T',T_{11,est},'P',P_{11}\times1000,\text{'CO2'})
   s_{11,est} = \text{refpropm}('s','T',T_{11,est},'P',P_{11}\times1000,\text{'CO2'})
   ```

2. 基于估计的副压缩机入口状态计算副压缩机出口：
   ```
   s_{12,is} = s_{11,est} \text{ (等熵过程)}
   h_{12,is} = \text{refpropm}('h','P',P_{12}\times1000,'S',s_{12,is},\text{'CO2'})
   h_{12} = h_{11,est} + \frac{h_{12,is} - h_{11,est}}{\eta_{RC}}
   ```

3. 计算合流点状态（预设值）：
   ```
   h_{13} = (1-\alpha) \times h_{10} + \alpha \times h_{12}
   ```

4. 使用回热器效率法估计冷侧出口温度：
   ```
   T_{5,guess} = 600 \text{ K (合理假设值)}
   T_{14} = T_{13} + \varepsilon_{LTR} \times (T_{5,guess} - T_{13})
   T_{15} = T_{14} + \varepsilon_{HTR} \times (T_4 - T_{14})
   ```

5. 反向计算回热器热侧状态：
   ```
   Q_{HTR,cold} = h_{15} - h_{14} \text{ (高温回热器冷侧吸热)}
   h_5 = h_4 - Q_{HTR,cold} \text{ (能量守恒)}
   
   Q_{LTR,cold} = h_{14} - h_{13} \text{ (低温回热器冷侧吸热)}
   h_6 = h_5 - Q_{LTR,cold} \text{ (能量守恒)}
   ```

6. 更新副压缩机和合流点状态：
   ```
   T_{11} = T_6 \text{ (更新分流点状态)}
   h_{12} = \text{更新后的副压缩机出口焓}
   h_{13} = (1-\alpha) \times h_{10} + \alpha \times h_{12} \text{ (重新计算合流点)}
   ```

#### 3.4.2 原温差估计法存在的问题

原来基于简单温差估计的方法存在以下问题：

1. **物理不合理性**：简单假设回热器出入口温差（如 $T_4 - T_5 = 50\text{ K}$）没有考虑实际的热力学性质和能量守恒。

2. **能量不平衡**：使用固定温差估计会导致回热器热侧放热量与冷侧吸热量不匹配，初始状态下违背能量守恒原则。

3. **超临界CO₂特性忽略**：超临界CO₂在不同压力、温度下比热容变化显著，简单温差估计没有考虑这一特性。

4. **收敛问题**：不合理的初始估计会导致迭代过程需要更多步骤才能收敛，甚至可能导致计算发散。

5. **系统耦合考虑不足**：未充分考虑副压缩机-分流-合流系统的热力学耦合关系。

新方法从合流点开始，基于能量守恒和设备效率反向推导，为后续迭代提供了更合理的起点，有助于提高计算精度和收敛性。

### 3.5 热平衡初始计算

高温回热器热侧出口计算：
$$Q_{HTR,cold} = h_{15} - h_{14} \text{ (冷侧吸热)}$$
$$h_5 = h_4 - Q_{HTR,cold} \text{ (热侧放热)}$$
$$T_5 = \text{refpropm}('t','P',P_5\times1000,'H',h_5,\text{'CO2'})$$
$$s_5 = \text{refpropm}('s','T',T_5,'P',P_5\times1000,\text{'CO2'})$$

低温回热器热侧出口计算：
$$Q_{LTR,cold} = h_{14} - h_{13} \text{ (冷侧吸热)}$$
$$h_6 = h_5 - Q_{LTR,cold} \text{ (热侧放热)}$$
$$T_6 = \text{refpropm}('t','P',P_6\times1000,'H',h_6,\text{'CO2'})$$
$$s_6 = \text{refpropm}('s','T',T_6,'P',P_6\times1000,\text{'CO2'})$$

### 3.6 分流点 (6→7, 6→11)

主路冷却器出口（点7）状态计算：
$$P_7 = P_6 \text{ (等压过程)}$$
$$T_7 = 305 \text{ K (冷却器出口温度)}$$
$$h_7 = \text{refpropm}('h','T',T_7,'P',P_7\times1000,\text{'CO2'})$$
$$s_7 = \text{refpropm}('s','T',T_7,'P',P_7\times1000,\text{'CO2'})$$

副路入口（点11，与点6相同）：
$$T_{11} = T_6$$
$$h_{11} = h_6$$
$$s_{11} = s_6$$

### 3.7 主压缩机a (7→8)

主压缩机a等熵过程计算：
$$s_{8,is} = s_7 \text{ (等熵过程)}$$
$$h_{8,is} = \text{refpropm}('h','P',P_8\times1000,'S',s_{8,is},\text{'CO2'})$$

考虑压缩机效率的实际出口焓：
$$h_8 = h_7 + \frac{h_{8,is} - h_7}{\eta_{MC,a}}$$

出口状态计算：
$$T_8 = \text{refpropm}('t','P',P_8\times1000,'H',h_8,\text{'CO2'})$$
$$s_8 = \text{refpropm}('s','T',T_8,'P',P_8\times1000,\text{'CO2'})$$

### 3.8 中间冷却器 (8→9)

中间冷却器出口状态计算：
$$P_9 = P_8 \text{ (等压过程)}$$
$$T_9 = 305 \text{ K (中间冷却器出口温度)}$$
$$h_9 = \text{refpropm}('h','T',T_9,'P',P_9\times1000,\text{'CO2'})$$
$$s_9 = \text{refpropm}('s','T',T_9,'P',P_9\times1000,\text{'CO2'})$$

### 3.9 主压缩机b (9→10)

主压缩机b等熵过程计算：
$$s_{10,is} = s_9 \text{ (等熵过程)}$$
$$h_{10,is} = \text{refpropm}('h','P',P_{10}\times1000,'S',s_{10,is},\text{'CO2'})$$

考虑压缩机效率的实际出口焓：
$$h_{10} = h_9 + \frac{h_{10,is} - h_9}{\eta_{MC,b}}$$

出口状态计算：
$$T_{10} = \text{refpropm}('t','P',P_{10}\times1000,'H',h_{10},\text{'CO2'})$$
$$s_{10} = \text{refpropm}('s','T',T_{10},'P',P_{10}\times1000,\text{'CO2'})$$

### 3.10 副压缩机 (11→12)

副压缩机等熵过程计算：
$$s_{12,is} = s_{11} \text{ (等熵过程)}$$
$$h_{12,is} = \text{refpropm}('h','P',P_{12}\times1000,'S',s_{12,is},\text{'CO2'})$$

考虑副压缩机效率的实际出口焓：
$$h_{12} = h_{11} + \frac{h_{12,is} - h_{11}}{\eta_{RC}}$$

出口状态计算：
$$T_{12} = \text{refpropm}('t','P',P_{12}\times1000,'H',h_{12},\text{'CO2'})$$
$$s_{12} = \text{refpropm}('s','T',T_{12},'P',P_{12}\times1000,\text{'CO2'})$$

### 3.11 合流点 (10,12→13)

合流点焓值计算（质量加权平均）：
$$h_{13} = (1-\alpha) \times h_{10} + \alpha \times h_{12}$$

合流点状态计算：
$$T_{13} = \text{refpropm}('t','P',P_{13}\times1000,'H',h_{13},\text{'CO2'})$$
$$s_{13} = \text{refpropm}('s','T',T_{13},'P',P_{13}\times1000,\text{'CO2'})$$

## 4. 热平衡迭代求解

### 4.1 迭代过程

热平衡迭代使用松弛系数法求解：

1. 计算高温回热器热交换：
   $$Q_{HTR,hot} = h_4 - h_5 \text{ (热侧放热)}$$
   $$Q_{HTR,cold} = h_{15} - h_{14} \text{ (冷侧吸热)}$$
   
   更新高温回热器热侧出口焓：
   $$h_{5,new} = h_4 - Q_{HTR,cold}$$
   $$h_5 = h_{5,old} + \text{relax} \times (h_{5,new} - h_{5,old})$$

2. 计算低温回热器热交换：
   $$Q_{LTR,hot} = h_5 - h_6 \text{ (热侧放热)}$$
   $$Q_{LTR,cold} = h_{14} - h_{13} \text{ (冷侧吸热)}$$
   
   更新低温回热器热侧出口焓：
   $$h_{6,new} = h_5 - Q_{LTR,cold}$$
   $$h_6 = h_{6,old} + \text{relax} \times (h_{6,new} - h_{6,old})$$

3. 更新分流点和压缩机状态：
   - 更新副压缩机入口状态（点11 = 点6）
   - 计算副压缩机出口状态（点12）
   - 计算合流点状态（点13）

4. 使用回热器效率更新冷侧出口状态：
   $$T_{14} = T_{13} + \varepsilon_{LTR} \times (T_5 - T_{13})$$
   $$T_{15} = T_{14} + \varepsilon_{HTR} \times (T_4 - T_{14})$$

5. 检查收敛性：
   $$dh_5 = \frac{|h_5 - h_{5,old}|}{|h_5|}$$
   $$dh_6 = \frac{|h_6 - h_{6,old}|}{|h_6|}$$
   $$dh_{14} = \frac{|h_{14} - h_{14,old}|}{|h_{14}|}$$
   $$dh_{15} = \frac{|h_{15} - h_{15,old}|}{|h_{15}|}$$
   
   如果 $\max(dh_5, dh_6, dh_{14}, dh_{15}) < 0.001$，则认为已收敛。

### 4.2 松弛参数

为确保迭代收敛，使用松弛系数：
$$\text{relax} = 0.5$$

## 5. 循环性能计算

### 5.1 功率计算

各组件功率计算：
$$W_{HP} = h_1 - h_2 \text{ (高压透平做功)}$$
$$W_{LP} = h_3 - h_4 \text{ (低压透平做功)}$$
$$W_{MC,a} = h_8 - h_7 \text{ (主压缩机a耗功)}$$
$$W_{MC,b} = h_{10} - h_9 \text{ (主压缩机b耗功)}$$
$$W_{RC} = h_{12} - h_{11} \text{ (副压缩机耗功)}$$

总压缩功率计算：
$$W_{comp} = (1-\alpha) \times (W_{MC,a} + W_{MC,b}) + \alpha \times W_{RC}$$

总透平功率计算：
$$W_{turb} = W_{HP} + W_{LP}$$

净输出功率计算：
$$W_{net} = W_{turb} - W_{comp}$$

### 5.2 热量计算

各热交换器热量计算：
$$Q_{heater} = h_1 - h_{15} \text{ (加热器)}$$
$$Q_{reheater} = h_3 - h_2 \text{ (再热器)}$$
$$Q_{cooler} = (1-\alpha) \times (h_6 - h_7) \text{ (主路冷却器)}$$
$$Q_{intercooler} = (1-\alpha) \times (h_8 - h_9) \text{ (中间冷却器)}$$

总输入热量计算：
$$Q_{in} = Q_{heater} + Q_{reheater}$$

### 5.3 循环效率

循环热效率计算：
$$\eta_{thermal} = \frac{W_{net}}{Q_{in}}$$

## 6. T-S图绘制

T-S图绘制涵盖以下内容：
- 主循环路径（1→2→3→4→5→6→7→8→9→10→13→14→15→1）
- 副路路径（6→11→12→13）
- 等压吸热过程（2→3，13→14→15→1）
- 等压放热过程（4→5→6，8→9）
- 压缩过程（7→8，9→10，11→12）
- 膨胀过程（1→2，3→4）

图中标记15个状态点，并通过图例和文本框说明各过程和系统性能参数。 